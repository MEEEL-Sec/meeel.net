<!DOCTYPE html>
<html>
 <head>
	<title>meeel.net</title>
	<link rel="stylesheet" type="text/css" href="../css/styles.css"/>
</head>
 <body>
<div class="banner">
<pre><h1>
+-+-+-+-+-+-+-+-+-+
|m|e|e|e|l|.|n|e|t|
+-+-+-+-+-+-+-+-+-+
</pre></h1>
   <p>low-bandwith retreat<p>
</div><br><br>

<h2>Improper Indexing Leads To Auth Bypass</h2>
I figured that for my first writeup post, I'd write about an issue I found in January 2021. The bug itself is a very easy fix and goes to show how small mistakes often lead to big impacts in security.<br><br>

<h3>Breakdown</h3>
I noticed two details during my manual recon of the application.
<ul>
<li>There are invitation IDs that users can share in the form of a link to invite trusted individuals to their administration teams</li>
<li>The links containing the invitation parameters never expire and are randomly generated</li>
</ul>
First thing I thought to myself was to Google dork, I often make use of Google dorking to find sensitive data already, so this was a natural part of the process. The query I issued was"<i>site:example.com inurl:invitations-param</i>" and there they were, multiple pages of exposed invitations that anyone with an internet connection could abuse to gain admin privileges in user environments and do whatever they please.
<h3>Cause</h3>
Almost every site on the internet has a robots.txt file, this file contains a list of rules for search engine "robots" that the robots must abide by in order to conceal endpoints on the application that the security team may not want the robots to view, think of it as an implementation of security through obscurity. A search engine robot reads the file and knows where it isn't allowed to crawl around and poke things. this site even has a robots.txt file, take a look <a href="https://meeel.net/robots.txt">robots.txt</a>.<br><br>

The bug was caused by a lack of two lines in the robots.txt<br><br>
User-Agent: *<br>
Disallow:/*?invitations-param=<br><br>

This bug scored me a P2 on Bugcrowd. Google dorking can go a very long way, if you see something exposed in a url that may need to be kept private, it never hurts to do some dorking. Here's a cheat sheet from SANS to get started <a href="https://www.sans.org/posters/google-hacking-and-defense-cheat-sheet">Cheat Sheet</a>
<br><br><br></body>
</html>
